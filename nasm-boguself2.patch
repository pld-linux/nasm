--- nasm-0.98.39/output/outelf.c.orig	2005-01-15 23:16:08.000000000 +0100
+++ nasm-0.98.39/output/outelf.c	2005-01-22 02:06:48.683321040 +0100
@@ -639,7 +639,7 @@
         r->symbol = 0;
         for (i = 0; i < nsects; i++)
             if (segment == sects[i]->index)
-                r->symbol = i + 3;
+                r->symbol = i + 2;
         if (!r->symbol)
             r->symbol = GLOBAL_TEMP_BASE + raa_read(bsym, segment);
     }
@@ -1097,13 +1097,13 @@
      * Now some standard symbols defining the segments, for relocation
      * purposes.
      */
-    for (i = 1; i <= nsects + 1; i++) {
+    for (i = 1; i <= nsects; i++) {
         p = entry;
         WRITELONG(p, 0);        /* no symbol name */
         WRITELONG(p, 0);        /* offset zero */
         WRITELONG(p, 0);        /* size zero */
         WRITESHORT(p, 3);       /* local section-type thing */
-        WRITESHORT(p, (i == 1 ? SHN_ABS : i - 1));      /* the section id */
+        WRITESHORT(p, i);
         saa_wbytes(s, entry, 16L);
         *len += 16;
         (*local)++;
@@ -1162,7 +1162,7 @@
         long sym = r->symbol;
 
         if (sym >= GLOBAL_TEMP_BASE)
-            sym += -GLOBAL_TEMP_BASE + (nsects + 3) + nlocals;
+            sym += -GLOBAL_TEMP_BASE + (nsects + 2) + nlocals;
 
         p = entry;
         WRITELONG(p, r->address);
