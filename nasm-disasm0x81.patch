diff -Nur nasm-0.98.08.orig/disasm.c nasm-0.98.08/disasm.c
--- nasm-0.98.08.orig/disasm.c	Mon Mar  5 13:05:23 2001
+++ nasm-0.98.08/disasm.c	Sat Jan 19 00:01:57 2002
@@ -377,13 +377,27 @@
 	    ins->oprs[c-070].offset |= (((long) *data++) << 24);
 	    ins->oprs[c-070].segment |= SEG_32BIT | SEG_RELATIVE;
 	}
-	if (c >= 0100 && c <= 0177) {
+	if (c >= 0100 && c <= 0127) {
 	    int modrm = *data++;
 	    ins->oprs[c & 07].basereg = (modrm >> 3) & 07;
 	    ins->oprs[c & 07].segment |= SEG_RMREG;
 	    data = do_ea (data, modrm, asize, segsize,
 			  &ins->oprs[(c >> 3) & 07]);
 	}
+	if (c >= 0130 && c <= 0132) {
+	    ins->oprs[c-0130].offset = *data++;
+	    ins->oprs[c-0130].offset |= (*data++ << 8);
+	}
+	if (c >= 0133 && c <= 0137)
+	    continue;
+	if (c >= 0140 && c <= 0142) {
+	    ins->oprs[c-0140].offset = *data++;
+	    ins->oprs[c-0140].offset |= (*data++ << 8);
+	    ins->oprs[c-0140].offset |= (((long) *data++) << 16);
+	    ins->oprs[c-0140].offset |= (((long) *data++) << 24);
+	}
+	if (c >= 0143 && c <= 0147)
+	    continue;
 	if (c >= 0200 && c <= 0277) {
 	    int modrm = *data++;
 	    if (((modrm >> 3) & 07) != (c & 07))
diff -Nur nasm-0.98.08.orig/insns.dat nasm-0.98.08/insns.dat
--- nasm-0.98.08.orig/insns.dat	Mon Mar  5 13:06:10 2001
+++ nasm-0.98.08/insns.dat	Fri Jan 18 23:05:53 2002
@@ -40,11 +40,11 @@
 ADC       reg_eax,sbyte       \321\1\x83\202\15                  386,ND
 ADC       reg_eax,imm         \321\1\x15\41                 386,SM
 ADC       rm8,imm             \300\1\x80\202\21             8086,SM
-ADC       rm16,imm            \320\300\134\1\x81\202\131         8086,SM,ND
-ADC       rm32,imm            \321\300\144\1\x81\202\141         386,SM,ND
+ADC       rm16,imm            \320\300\134\1\x81\202\131         8086,SM
+ADC       rm32,imm            \321\300\144\1\x81\202\141         386,SM
 ADC       mem,imm8            \300\1\x80\202\21             8086,SM
-ADC       mem,imm16           \320\300\134\1\x81\202\131         8086,SM,ND
-ADC       mem,imm32           \321\300\144\1\x81\202\141         386,SM,ND
+ADC       mem,imm16           \320\300\134\1\x81\202\131         8086,SM
+ADC       mem,imm32           \321\300\144\1\x81\202\141         386,SM
 ADD       mem,reg8            \300\17\101                   8086,SM
 ADD       reg8,reg8           \300\17\101                   8086
 ADD       mem,reg16           \320\300\1\x01\101            8086,SM
@@ -64,11 +64,11 @@
 ADD       reg_eax,sbyte       \321\1\x83\200\15                  386,ND
 ADD       reg_eax,imm         \321\1\x05\41                 386,SM
 ADD       rm8,imm             \300\1\x80\200\21             8086,SM
-ADD       rm16,imm            \320\300\134\1\x81\200\131         8086,SM,ND
-ADD       rm32,imm            \321\300\144\1\x81\200\141         386,SM,ND
+ADD       rm16,imm            \320\300\134\1\x81\200\131         8086,SM
+ADD       rm32,imm            \321\300\144\1\x81\200\141         386,SM
 ADD       mem,imm8            \300\1\x80\200\21             8086,SM
-ADD       mem,imm16           \320\300\134\1\x81\200\131         8086,SM,ND
-ADD       mem,imm32           \321\300\144\1\x81\200\141         386,SM,ND
+ADD       mem,imm16           \320\300\134\1\x81\200\131         8086,SM
+ADD       mem,imm32           \321\300\144\1\x81\200\141         386,SM
 AND       mem,reg8            \300\1\x20\101                8086,SM
 AND       reg8,reg8           \300\1\x20\101                8086
 AND       mem,reg16           \320\300\1\x21\101            8086,SM
@@ -88,11 +88,11 @@
 AND       reg_eax,sbyte       \321\1\x83\204\15                  386,ND
 AND       reg_eax,imm         \321\1\x25\41                 386,SM
 AND       rm8,imm             \300\1\x80\204\21             8086,SM
-AND       rm16,imm            \320\300\134\1\x81\204\131         8086,SM,ND
-AND       rm32,imm            \321\300\144\1\x81\204\141         386,SM,ND
+AND       rm16,imm            \320\300\134\1\x81\204\131         8086,SM
+AND       rm32,imm            \321\300\144\1\x81\204\141         386,SM
 AND       mem,imm8            \300\1\x80\204\21             8086,SM
-AND       mem,imm16           \320\300\134\1\x81\204\131         8086,SM,ND
-AND       mem,imm32           \321\300\144\1\x81\204\141         386,SM,ND
+AND       mem,imm16           \320\300\134\1\x81\204\131         8086,SM
+AND       mem,imm32           \321\300\144\1\x81\204\141         386,SM
 ARPL      mem,reg16           \300\1\x63\101                286,PROT,SM
 ARPL      reg16,reg16         \300\1\x63\101                286,PROT
 BOUND     reg16,mem           \320\301\1\x62\110            186
@@ -181,11 +181,11 @@
 CMP       reg_eax,sbyte       \321\1\x83\207\15                  386,ND
 CMP       reg_eax,imm         \321\1\x3D\41                 386,SM
 CMP       rm8,imm             \300\1\x80\207\21             8086,SM
-CMP       rm16,imm            \320\300\134\1\x81\207\131         8086,SM,ND
-CMP       rm32,imm            \321\300\144\1\x81\207\141         386,SM,ND
+CMP       rm16,imm            \320\300\134\1\x81\207\131         8086,SM
+CMP       rm32,imm            \321\300\144\1\x81\207\141         386,SM
 CMP       mem,imm8            \300\1\x80\207\21             8086,SM
-CMP       mem,imm16           \320\300\134\1\x81\207\131         8086,SM,ND
-CMP       mem,imm32           \321\300\144\1\x81\207\141         386,SM,ND
+CMP       mem,imm16           \320\300\134\1\x81\207\131         8086,SM
+CMP       mem,imm32           \321\300\144\1\x81\207\141         386,SM
 CMPSB     void                \332\1\xA6                    8086
 CMPSD     void                \332\321\1\xA7                386
 CMPSW     void                \332\320\1\xA7                8086
@@ -640,11 +640,11 @@
 OR        reg_eax,sbyte       \321\1\x83\201\15                  386,ND
 OR        reg_eax,imm         \321\1\x0D\41                 386,SM
 OR        rm8,imm             \300\1\x80\201\21             8086,SM
-OR        rm16,imm            \320\300\134\1\x81\201\131         8086,SM,ND
-OR        rm32,imm            \321\300\144\1\x81\201\141         386,SM,ND
+OR        rm16,imm            \320\300\134\1\x81\201\131         8086,SM
+OR        rm32,imm            \321\300\144\1\x81\201\141         386,SM
 OR        mem,imm8            \300\1\x80\201\21             8086,SM
-OR        mem,imm16           \320\300\134\1\x81\201\131         8086,SM,ND
-OR        mem,imm32           \321\300\144\1\x81\201\141         386,SM,ND
+OR        mem,imm16           \320\300\134\1\x81\201\131         8086,SM
+OR        mem,imm32           \321\300\144\1\x81\201\141         386,SM
 OUT       imm,reg_al          \1\xE6\24                     8086,SB
 OUT       imm,reg_ax          \320\1\xE7\24                 8086,SB
 OUT       imm,reg_eax         \321\1\xE7\24                 386,SB
@@ -931,11 +931,11 @@
 SBB       reg_eax,sbyte       \321\1\x83\203\15                  386,ND
 SBB       reg_eax,imm         \321\1\x1D\41                 386,SM
 SBB       rm8,imm             \300\1\x80\203\21             8086,SM
-SBB       rm16,imm            \320\300\134\1\x81\203\131         8086,SM,ND
-SBB       rm32,imm            \321\300\144\1\x81\203\141         386,SM,ND
+SBB       rm16,imm            \320\300\134\1\x81\203\131         8086,SM
+SBB       rm32,imm            \321\300\144\1\x81\203\141         386,SM
 SBB       mem,imm8            \300\1\x80\203\21             8086,SM
-SBB       mem,imm16           \320\300\134\1\x81\203\131         8086,SM,ND
-SBB       mem,imm32           \321\300\144\1\x81\203\141         386,SM,ND
+SBB       mem,imm16           \320\300\134\1\x81\203\131         8086,SM
+SBB       mem,imm32           \321\300\144\1\x81\203\141         386,SM
 SCASB     void                \332\1\xAE                    8086
 SCASD     void                \332\321\1\xAF                386
 SCASW     void                \332\320\1\xAF                8086
@@ -1013,11 +1013,11 @@
 SUB       reg_eax,sbyte       \321\1\x83\205\15                  386,ND
 SUB       reg_eax,imm         \321\1\x2D\41                 386,SM
 SUB       rm8,imm             \300\1\x80\205\21             8086,SM
-SUB       rm16,imm            \320\300\134\1\x81\205\131         8086,SM,ND
-SUB       rm32,imm            \321\300\144\1\x81\205\141         386,SM,ND
+SUB       rm16,imm            \320\300\134\1\x81\205\131         8086,SM
+SUB       rm32,imm            \321\300\144\1\x81\205\141         386,SM
 SUB       mem,imm8            \300\1\x80\205\21             8086,SM
-SUB       mem,imm16           \320\300\134\1\x81\205\131         8086,SM,ND
-SUB       mem,imm32           \321\300\144\1\x81\205\141         386,SM,ND
+SUB       mem,imm16           \320\300\134\1\x81\205\131         8086,SM
+SUB       mem,imm32           \321\300\144\1\x81\205\141         386,SM
 SVDC	  mem80,reg_sreg      \300\2\x0F\x78\101            486,CYRIX,SMM
 SVLDT     mem80               \300\2\x0F\x7A\200            486,CYRIX,SMM
 SVTS      mem80               \300\2\x0F\x7C\200            486,CYRIX,SMM
@@ -1115,11 +1115,11 @@
 XOR       reg_eax,sbyte       \321\1\x83\206\15                  386,ND
 XOR       reg_eax,imm         \321\1\x35\41                 386,SM
 XOR       rm8,imm             \300\1\x80\206\21             8086,SM
-XOR       rm16,imm            \320\300\134\1\x81\206\131         8086,SM,ND
-XOR       rm32,imm            \321\300\144\1\x81\206\141         386,SM,ND
+XOR       rm16,imm            \320\300\134\1\x81\206\131         8086,SM
+XOR       rm32,imm            \321\300\144\1\x81\206\141         386,SM
 XOR       mem,imm8            \300\1\x80\206\21             8086,SM
-XOR       mem,imm16           \320\300\134\1\x81\206\131         8086,SM,ND
-XOR       mem,imm32           \321\300\144\1\x81\206\141         386,SM,ND
+XOR       mem,imm16           \320\300\134\1\x81\206\131         8086,SM
+XOR       mem,imm32           \321\300\144\1\x81\206\141         386,SM
 CMOVcc    reg16,mem           \320\301\1\x0F\330\x40\110    P6,SM
 CMOVcc    reg16,reg16         \320\301\1\x0F\330\x40\110    P6
 CMOVcc    reg32,mem           \321\301\1\x0F\330\x40\110    P6,SM
